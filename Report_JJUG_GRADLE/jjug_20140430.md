# [【東京】 JJUG&JGGUG 共催ナイトセミナ 「4.30 2時間で分かる！次世代ビルドツールの本命Gradleの全貌」](http://jjug.doorkeeper.jp/events/10618)

# 「導入編」 by 須江信洋氏 (@nobusue)

- [資料](http://www.slideshare.net/nobusue/jjug-20140430-gradleintro)

- Japan Grails/Groovy User Group

## Gradle概要

- エンタープライズオートメーションを目指している

### Gradleとは
  - Ant/Mavenの課題を解決するビルドツール
  - 標準化と柔軟性の両立
  - ビルドスクリプトはGroovyで記述(ファイル操作が楽だったり)

    - 利用事例:Hivernate、Spring

### ビルドツールの歴史

- 手続き型-
- スクリプト-XML
  
| ビルドツール名 | 特徴                                                                    |  
| :------------- | :---------------------------------------------------------------------- |  
| Make           | UNIXの文脈でよく使われる                                                |  
| Ant            | JavaとXMLでクロスプラットフォームを実現                                 |  
| Maven          | ビルドにドメインモデル(POM)と「依存性管理」を導入                       |  
| Gradle         | ビルドを「言語内DSL」で記述。ドメインモデルをスクリプトで直接操作する。 |  

### Gradle DSL

  - Gradleが独自に定義する文法
  - 条件分岐=Groovyのifを使って見通しよくかける
  - Tomcatプラグインを使っている場合にsrc/main/WEB-INF以下に出力したい場合にも対応可能

### マルチプロジェクト

  - 複数プロジェクトから構成されるプロジェクトのビルドを定義
  - サブプロジェクト間の依存関係を定義可能
  - サブプロジェクトに共通する処理や設定の一元化が可能
  - Gradleのkiller featureの一つ
 
### Gradleラッパー

  - Gradleの個別導入を不要にした
  - Gradleラッパーの有効なケース

    - JenkinsなどのCI環境
    - 開発者の環境構築負荷の軽減
    - 利用するGradleのバージョン統一

  - Gradle導入済みの環境で
    ```
      gradle wrapper
    ```
    するとGradleのブートストラップが生成される

### Gradleデーモン

  - Gradleのプロセスを常駐し、起動を高速化
  - GRADLE_OPTSまたはgradle.propertiesに一行追加するとデフォルトに

## Gradleの利用方法

### Gradleインストール

  - 前提

    - JDK1.5以上

  * GVM利用 →オススメ!
  * ZIPを展開

## Gradleのロードマップ

  - 2014/04/30時点では1.12が最新
  - 1.xは1.12で最後。次は2.0
  - 最近の重点強化ポイント

    - 依存関係管理を柔軟・緻密に
    - ビルドのパラレル化
    - IDE連携
    - ネイティブ(C言語系)ビルド対応

# 「基礎編」 by 綿引琢磨氏 (@bikisuke)

- [資料](http://www.slideshare.net/bikisuke/jjug-20140430-gradlebasic)

## Gradleのアーキテクチャ

  - 自動化のための基板とプラグイン機構による疎結合な構造
  
    - 自動化のためのインフラとドメインオブジェクト群
    -

## Gradleの三大要素

  - プロジェクト

    - 処理対象を表すコアドメイン
    - 必ず一つある

  - タスク

    - 作業単位を表すコアドメイン
    - ユーザが実行できる最小単位

  - プラグイン

    - 特定処理のための機能コンポーネント
    - タスク、プロパティ、規約をパッケージングされている

## Javaプロジェクトの生成

  - gradle init --type <type>で指定した初期化タイプのひな形を作成する

    - e.g gradle init --type javaでJava規約にあったプロジェクト構成を作ってくれる

  - Javaプラグインとは

    * Javaプロジェクトのコンパイル、テスト、アーカイブに必要なタスク・プロパティ・規約を提供する

## マルチプロジェクト

  - 基点となるルートプロジェクトにサブプロジェクトがツリー構造をなす
  - Gradleがサポートするレイアウトは以下の2つ。レイアウトはルートプロジェクトとサブプロジェクトの位置関係で決まる

    * 階層レイアウト
    * フラットレイアウト

  - ビルドスクリプトの定義するプラクティス

    * ルートプロジェクトに集約して定義する
    * ルートプロジェクトに共通設定を定義、サブプロジェクトに差分を定義する
    * 個別に定義する

  - マルチプロジェクトの勘所
    * レイアウト構成に関して

      - 特定のシステムやサービスの中で使用することが明らかな場合には階層レイアウトが良い →Intellijはこちらがオススメ!!
      - 他システムでも使用するもの、汎用的なライブラリはふらっとレイアウトもしくは単一のプロジェクトとしておいたほうが柔軟に対応できる
  
    * ビルドスクリプトに関して

      - 基本はルートプロジェクトに共通設定を定義して差分をサブプロジェクトにするのが城跡
      - 専任のメンテナがいる場合には個別でもokかも。

# 「発展編 ~会社で使うGradle~」 by 林政利氏 (@literalice)

- [資料](http://www.slideshare.net/literalice/gradle-34150436)

## 信頼性の高いビルド

  - キャッシュを利用した依存性解決
  - Gradleのラッパー
  - 比較ビルド

## 気軽なカスタマイズ
## 既存環境の利用

  - Ant(ファーストクラスオブジェクトとして扱える)
  - 社内リポジトリ
  - build.xml

### Mavenを使う場合

  - Mavenプラグインを使うことはできない
  - pom.xmlを活用することができる

    - pom.xml -> gradle init --type pom -> build.gradle

